SELECT
SHE.TORIHIKISAKI_CD      AS TORIHIKISAKI_CD,
SHE.KYOTEN_CD            AS KYOTEN_CD,
SHE.SYSTEM_ID            AS SYSTEM_ID,
SHE.SEQ                  AS SEQ,
SHD.DETAIL_SYSTEM_ID     AS DETAIL_SYSTEM_ID,
SHD.ROW_NUMBER           AS ROW_NO,
SHE.SHUKKIN_NUMBER       AS DENPYOU_NUMBER,
SHE.DENPYOU_DATE         AS DENPYOU_DATE,
ISNULL(SHD.KINGAKU,0)    AS GOUKEIGAKU
FROM
T_SHUKKIN_ENTRY SHE RIGHT OUTER JOIN T_SHUKKIN_DETAIL SHD
ON SHE.SYSTEM_ID = SHD.SYSTEM_ID AND SHE.SEQ = SHD.SEQ
/*BEGIN*/WHERE
/*IF !deletechuFlg*/SHE.DELETE_FLG = 0/*END*/
/*IF data.KYOTEN_CD != 99*/
 AND SHE.KYOTEN_CD = /*data.KYOTEN_CD*//*END*/
/*IF data.SHIHARAISHIMEBI_FROM != null && data.SHIHARAISHIMEBI_FROM != ""*/
 AND CONVERT(DATETIME, SHE.DENPYOU_DATE,111) >= CONVERT(DATETIME, /*data.SHIHARAISHIMEBI_FROM*/null,111)
 AND CONVERT(DATETIME, SHE.DENPYOU_DATE,111) <= CONVERT(DATETIME, /*data.SHIHARAISHIMEBI_TO*/null,111)
 -- ELSE AND CONVERT(DATETIME, SHE.DENPYOU_DATE,111) <= CONVERT(DATETIME, /*data.SHIHARAISHIMEBI_TO*/null,111)/*END*/
 AND SHE.TORIHIKISAKI_CD = /*data.SHIHARAI_CD*/
 /*IF data.DENPYOU_BANGOU != 0*/ AND SHE.SHUKKIN_NUMBER = /*data.DENPYOU_BANGOU*//*END*/
 AND NOT EXISTS (
    SELECT
        1 
    FROM
        T_SEISAN_DENPYOU AS SEIE
        INNER JOIN T_SEISAN_DETAIL SEIDE
        ON SEIE.SEISAN_NUMBER = SEIDE.SEISAN_NUMBER AND SEIDE.DELETE_FLG = 0
    WHERE
        SEIDE.DENPYOU_SHURUI_CD = 20
        AND SEIDE.DENPYOU_SYSTEM_ID = SHD.SYSTEM_ID 
        AND SEIDE.DENPYOU_SEQ = SHD.SEQ 
        AND SEIDE.DETAIL_SYSTEM_ID = SHD.DETAIL_SYSTEM_ID
		/*IF data.SAISHIME_FLG && data.SAISHIME_NUMBER_LIST.Count > 0*/
		AND SEIDE.SEISAN_NUMBER NOT IN /*data.SAISHIME_NUMBER_LIST*/(0)
		/*END*/
		)
/*END*/