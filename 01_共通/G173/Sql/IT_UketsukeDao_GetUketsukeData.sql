SELECT TOP(100)
	T0.UKETSUKE_KBN,
	T0.SAGYOU_DATE,
	T0.GENCHAKU_TIME,
	T0.UKETSUKE_DATE,
	T0.UKETSUKE_NUMBER,
	T0.TORIHIKISAKI_CD,
	T0.TORIHIKISAKI_NAME,
	T0.GYOUSHA_CD,
	T0.GYOUSHA_NAME,
	T0.GENBA_CD,
	T0.GENBA_NAME,
	T0.UNPAN_GYOUSHA_CD,
	T0.UNPAN_GYOUSHA_NAME,
	T0.SHASHU_NAME,
	T0.SHARYOU_NAME,
	T0.UNTENSHA_NAME,
	T0.KINGAKU_TOTAL,
	T0.SHOUHIZEI_TOTAL,
	T0.SYSTEM_ID,
	T0.SEQ,
	T0.UPDATE_DATE


FROM
(
SELECT 
	'収集' AS UKETSUKE_KBN,
	T1.SAGYOU_DATE AS SAGYOU_DATE,
	T1.GENCHAKU_TIME AS GENCHAKU_TIME,
	T1.UKETSUKE_DATE AS UKETSUKE_DATE,
	T1.UKETSUKE_NUMBER AS UKETSUKE_NUMBER,
	T1.GYOUSHA_CD AS GYOUSHA_CD,
	T1.GYOUSHA_NAME AS GYOUSHA_NAME,
	T1.GENBA_CD AS GENBA_CD,
	T1.GENBA_NAME AS GENBA_NAME,
	T1.UNPAN_GYOUSHA_CD AS UNPAN_GYOUSHA_CD,
	T1.UNPAN_GYOUSHA_NAME AS UNPAN_GYOUSHA_NAME,
	T1.SHARYOU_NAME AS SHARYOU_NAME,
	T1.SHASHU_NAME AS SHASHU_NAME,
	T1.UNTENSHA_NAME AS UNTENSHA_NAME,
	T1.TORIHIKISAKI_CD AS TORIHIKISAKI_CD,
	T1.TORIHIKISAKI_NAME AS TORIHIKISAKI_NAME,
	T1.KINGAKU_TOTAL AS KINGAKU_TOTAL,
	T1.SHOUHIZEI_TOTAL AS SHOUHIZEI_TOTAL,
	T1.SYSTEM_ID AS SYSTEM_ID,
	T1.SEQ AS SEQ,
	T1.UPDATE_DATE as UPDATE_DATE


FROM dbo.T_UKETSUKE_SS_ENTRY AS T1 ,(SELECT MAX(SEQ) AS SEQ,SYSTEM_ID FROM T_UKETSUKE_SS_ENTRY   group by SYSTEM_ID) AS TX

WHERE 
1=1
/*IF !torihikisakiCd.IsNull && ''!=torihikisakiCd*/AND T1.TORIHIKISAKI_CD = /*torihikisakiCd*/0 /*END*/
/*IF !gyoushaCd.IsNull && ''!=gyoushaCd*/AND T1.GYOUSHA_CD = /*gyoushaCd*/0 /*END*/
/*IF !genbaCd.IsNull && ''!=genbaCd*/AND T1.GENBA_CD = /*genbaCd*/0 /*END*/
/*IF !kyotenCd.IsNull && ''!=kyotenCd && '99'!=kyotenCd*/AND T1.KYOTEN_CD = /*kyotenCd*//*END*/
/*IF !fromDate.IsNull && ''!=fromDate*/AND CONVERT(varchar(10), T1.SAGYOU_DATE, 120) >= /*fromDate*//*END*/
/*IF !toDate.IsNull && ''!=toDate*/AND CONVERT(varchar(10), T1.SAGYOU_DATE, 120) <= /*toDate*//*END*/
AND T1.SEQ = TX.SEQ  AND T1.SYSTEM_ID = TX.SYSTEM_ID
AND T1.DELETE_FLG = 0

--ORDER BY T1.UPDATE_DATE desc

UNION 
SELECT 
	'出荷' AS UKETSUKE_KBN,
	T2.SAGYOU_DATE AS SAGYOU_DATE,
	T2.GENCHAKU_TIME AS GENCHAKU_TIME,
	T2.UKETSUKE_DATE AS UKETSUKE_DATE,
	T2.UKETSUKE_NUMBER AS UKETSUKE_NUMBER,
	T2.GYOUSHA_CD AS GYOUSHA_CD,
	T2.GYOUSHA_NAME AS GYOUSHA_NAME,
	T2.GENBA_CD AS GENBA_CD,
	T2.GENBA_NAME AS GENBA_NAME,
	T2.UNPAN_GYOUSHA_CD AS UNPAN_GYOUSHA_CD,
	T2.UNPAN_GYOUSHA_NAME AS UNPAN_GYOUSHA_NAME,
	T2.SHARYOU_NAME AS SHARYOU_NAME,
	T2.SHASHU_NAME AS SHASHU_NAME,
	T2.UNTENSHA_NAME AS UNTENSHA_NAME,
	T2.TORIHIKISAKI_CD AS TORIHIKISAKI_CD,
	T2.TORIHIKISAKI_NAME AS TORIHIKISAKI_NAME,
	T2.KINGAKU_TOTAL AS KINGAKU_TOTAL,
	T2.SHOUHIZEI_TOTAL AS SHOUHIZEI_TOTAL,
	T2.SYSTEM_ID AS SYSTEM_ID,
	T2.SEQ AS SEQ,
	T2.UPDATE_DATE as UPDATE_DATE


FROM dbo.T_UKETSUKE_SK_ENTRY AS T2,(SELECT MAX(SEQ) AS SEQ,SYSTEM_ID FROM T_UKETSUKE_SK_ENTRY   group by SYSTEM_ID) AS TX

WHERE 
1=1
/*IF !torihikisakiCd.IsNull && ''!=torihikisakiCd*/AND T2.TORIHIKISAKI_CD = /*torihikisakiCd*/0 /*END*/
/*IF !gyoushaCd.IsNull && ''!=gyoushaCd*/AND T2.GYOUSHA_CD = /*gyoushaCd*/0 /*END*/
/*IF !genbaCd.IsNull && ''!=genbaCd*/AND T2.GENBA_CD = /*genbaCd*/0 /*END*/
/*IF !kyotenCd.IsNull && ''!=kyotenCd && '99'!=kyotenCd*/AND T2.KYOTEN_CD = /*kyotenCd*//*END*/
/*IF !fromDate.IsNull && ''!=fromDate*/AND CONVERT(varchar(10), T2.SAGYOU_DATE, 120) >= /*fromDate*//*END*/
/*IF !toDate.IsNull && ''!=toDate*/AND CONVERT(varchar(10), T2.SAGYOU_DATE, 120) <= /*toDate*//*END*/
AND T2.SEQ = TX.SEQ  AND T2.SYSTEM_ID = TX.SYSTEM_ID
AND T2.DELETE_FLG = 0

UNION 
SELECT 
	'持込' AS UKETSUKE_KBN,
	T3.SAGYOU_DATE AS SAGYOU_DATE,
	T3.GENCHAKU_TIME AS GENCHAKU_TIME,
	T3.UKETSUKE_DATE AS UKETSUKE_DATE,
	T3.UKETSUKE_NUMBER AS UKETSUKE_NUMBER,
	T3.GYOUSHA_CD AS GYOUSHA_CD,
	T3.GYOUSHA_NAME AS GYOUSHA_NAME,
	T3.GENBA_CD AS GENBA_CD,
	T3.GENBA_NAME AS GENBA_NAME,
	T3.UNPAN_GYOUSHA_CD AS UNPAN_GYOUSHA_CD,
	T3.UNPAN_GYOUSHA_NAME AS UNPAN_GYOUSHA_NAME,
	T3.SHARYOU_NAME AS SHARYOU_NAME,
	T3.SHASHU_NAME AS SHASHU_NAME,
	'' AS UNTENSHA_NAME,
	T3.TORIHIKISAKI_CD AS TORIHIKISAKI_CD,
	T3.TORIHIKISAKI_NAME AS TORIHIKISAKI_NAME,
	T3.KINGAKU_TOTAL AS KINGAKU_TOTAL,
	T3.SHOUHIZEI_TOTAL AS SHOUHIZEI_TOTAL,
	T3.SYSTEM_ID AS SYSTEM_ID,
	T3.SEQ AS SEQ,
	T3.UPDATE_DATE as UPDATE_DATE


FROM dbo.T_UKETSUKE_MK_ENTRY AS T3 ,(SELECT MAX(SEQ) AS SEQ,SYSTEM_ID FROM T_UKETSUKE_MK_ENTRY   group by SYSTEM_ID) AS TX

WHERE 
1=1
/*IF !torihikisakiCd.IsNull && ''!=torihikisakiCd*/AND T3.TORIHIKISAKI_CD = /*torihikisakiCd*/0 /*END*/
/*IF !gyoushaCd.IsNull && ''!=gyoushaCd*/AND T3.GYOUSHA_CD = /*gyoushaCd*/0 /*END*/
/*IF !genbaCd.IsNull && ''!=genbaCd*/AND T3.GENBA_CD = /*genbaCd*/0 /*END*/
/*IF !kyotenCd.IsNull && ''!=kyotenCd && '99'!=kyotenCd*/AND T3.KYOTEN_CD = /*kyotenCd*//*END*/
/*IF !fromDate.IsNull && ''!=fromDate*/AND CONVERT(varchar(10), T3.SAGYOU_DATE, 120) >= /*fromDate*//*END*/
/*IF !toDate.IsNull && ''!=toDate*/AND CONVERT(varchar(10), T3.SAGYOU_DATE, 120) <= /*toDate*//*END*/
AND T3.SEQ = TX.SEQ  AND T3.SYSTEM_ID = TX.SYSTEM_ID
AND T3.DELETE_FLG = 0
) AS T0

ORDER BY SAGYOU_DATE desc, SYSTEM_ID asc