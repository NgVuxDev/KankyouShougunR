SELECT
	DENPYOU.TORIHIKISAKI_CD					--支払先CD
	,TORIHIKISAKI.TORIHIKISAKI_NAME_RYAKU	--支払先名
	,CASE DENPYOU.SHIHARAI_KEITAI_KBN
        WHEN 1 THEN NULL
        ELSE DENPYOU.ZENKAI_KURIKOSI_GAKU
     END AS ZENKAI_KURIKOSI_GAKU			--前回精算額
	,CASE DENPYOU.SHIHARAI_KEITAI_KBN
        WHEN 1 THEN NULL
        ELSE DENPYOU.KONKAI_SHUKKIN_GAKU
     END AS KONKAI_SHUKKIN_GAKU			--出金額
	,CASE DENPYOU.SHIHARAI_KEITAI_KBN
        WHEN 1 THEN NULL
        ELSE DENPYOU.KONKAI_CHOUSEI_GAKU
     END AS KONKAI_CHOUSEI_GAKU			--調整額
	,CASE DENPYOU.SHIHARAI_KEITAI_KBN
        WHEN 1 THEN NULL
        ELSE (ISNULL(DENPYOU.ZENKAI_KURIKOSI_GAKU,0) 
		- ISNULL(DENPYOU.KONKAI_SHUKKIN_GAKU,0) 
		- ISNULL(DENPYOU.KONKAI_CHOUSEI_GAKU,0))
        END AS KURIKOSHI_GAKU						--繰越額
	,DENPYOU.SHIMEBI						--締日
	,DENPYOU.KONKAI_SHIHARAI_GAKU				--今回取引額(税抜）
	,(ISNULL(DENPYOU.KONKAI_SEI_UTIZEI_GAKU,0) 
		+ ISNULL(DENPYOU.KONKAI_SEI_SOTOZEI_GAKU,0)  
		+ ISNULL(DENPYOU.KONKAI_DEN_UTIZEI_GAKU,0)  
		+ ISNULL(DENPYOU.KONKAI_DEN_SOTOZEI_GAKU,0)  
		+ ISNULL(DENPYOU.KONKAI_MEI_UTIZEI_GAKU,0) 
		+ ISNULL(DENPYOU.KONKAI_MEI_SOTOZEI_GAKU,0)
	)AS SHOUHIZEI							--消費税
	,CASE DENPYOU.SHIHARAI_KEITAI_KBN
        WHEN 1 THEN (ISNULL(DENPYOU.KONKAI_SHIHARAI_GAKU,0)
            + ISNULL(DENPYOU.KONKAI_SEI_UTIZEI_GAKU,0)
            + ISNULL(DENPYOU.KONKAI_SEI_SOTOZEI_GAKU,0)
            + ISNULL(DENPYOU.KONKAI_DEN_UTIZEI_GAKU,0)
            + ISNULL(DENPYOU.KONKAI_DEN_SOTOZEI_GAKU,0)
            + ISNULL(DENPYOU.KONKAI_MEI_UTIZEI_GAKU,0)
            + ISNULL(DENPYOU.KONKAI_MEI_SOTOZEI_GAKU,0))
        ELSE DENPYOU.KONKAI_SEISAN_GAKU
     END AS KONKAI_SEISAN_GAKU				--今回御精算額
	,DENPYOU.SHUKKIN_YOTEI_BI				--出金予定日
	,DENPYOU.SEISAN_DATE					--精算年月日
    ,DENPYOU.SHIHARAI_KEITAI_KBN
FROM 
	T_SEISAN_DENPYOU AS DENPYOU
	INNER JOIN M_TORIHIKISAKI AS TORIHIKISAKI
		ON TORIHIKISAKI.TORIHIKISAKI_CD = DENPYOU.TORIHIKISAKI_CD 
WHERE
	DENPYOU.DELETE_FLG = 0
	/*IF !data.HIDUKE_FROM.IsNull*/ AND DENPYOU.SEISAN_DATE >= /*data.HIDUKE_FROM*//*END*/
	/*IF !data.HIDUKE_TO.IsNull*/ AND DENPYOU.SEISAN_DATE <= /*data.HIDUKE_TO*//*END*/
	/*IF data.TORIHIKISAKI_CD_FROM !='' */ AND DENPYOU.TORIHIKISAKI_CD >= /*data.TORIHIKISAKI_CD_FROM*//*END*/
	/*IF data.TORIHIKISAKI_CD_TO !='' */ AND DENPYOU.TORIHIKISAKI_CD <= /*data.TORIHIKISAKI_CD_TO*//*END*/
  /*IF !data.KYOTEN_CD.IsNull*/ AND (DENPYOU.KYOTEN_CD = /*data.KYOTEN_CD*/ OR /*data.KYOTEN_CD*/ = 99) /*END*/
  /*IF !data.TORIHIKISAKI_SORT.IsNull && data.TORIHIKISAKI_SORT == '1'*/ ORDER BY TORIHIKISAKI.TORIHIKISAKI_FURIGANA, DENPYOU.TORIHIKISAKI_CD, DENPYOU.SEISAN_DATE ASC /*END*/
  /*IF !data.TORIHIKISAKI_SORT.IsNull && data.TORIHIKISAKI_SORT == '2'*/ ORDER BY DENPYOU.TORIHIKISAKI_CD ASC /*END*/