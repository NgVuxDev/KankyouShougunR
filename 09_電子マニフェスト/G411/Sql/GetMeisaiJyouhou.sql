SELECT DT_R24.MANIFEST_ID AS MANIFEST_ID,
       CASE WHEN DT_R24.TUUCHI_DATE IS NULL OR LTRIM(RTRIM(DT_R24.TUUCHI_DATE))= '' THEN ''
            WHEN DT_R24.TUUCHI_TIME IS NULL OR LTRIM(RTRIM(DT_R24.TUUCHI_TIME))= '' 
			    THEN SUBSTRING(DT_R24.TUUCHI_DATE,1,4) + '/' + 
                SUBSTRING(DT_R24.TUUCHI_DATE,5,2) + '/' + SUBSTRING(DT_R24.TUUCHI_DATE,7,2)
            ELSE SUBSTRING(DT_R24.TUUCHI_DATE,1,4) + '/' + SUBSTRING(DT_R24.TUUCHI_DATE,5,2) + '/' + 
                SUBSTRING(DT_R24.TUUCHI_DATE,7,2) + ' ' + SUBSTRING(DT_R24.TUUCHI_TIME,1,2) + ':' + 
                SUBSTRING(DT_R24.TUUCHI_TIME,3,2) + ':' + SUBSTRING(DT_R24.TUUCHI_TIME,5,2) 
       END  AS TUUCHI_DATE_TIME
      ,CASE WHEN DT_R24.HIKIWATASHI_DATE IS NULL OR LTRIM(RTRIM(DT_R24.HIKIWATASHI_DATE))= '' THEN ''
            ELSE SUBSTRING(DT_R24.HIKIWATASHI_DATE,1,4) + '/' + 
                SUBSTRING(DT_R24.HIKIWATASHI_DATE,5,2) + '/' + 
                SUBSTRING(DT_R24.HIKIWATASHI_DATE,7,2) 
       END AS HIKIWATASHI_DATE
      ,DT_R24.HST_JOU_NAME AS HST_JOU_NAME
      ,DT_R24.UPN_ROUTE_NO AS UPN_ROUTE_NO
      ,CASE WHEN DT_R24.END_DATE IS NULL  OR LTRIM(RTRIM(DT_R24.END_DATE))= '' THEN ''
            ELSE SUBSTRING(DT_R24.END_DATE,1,4) + '/' + 
                SUBSTRING(DT_R24.END_DATE,5,2) + '/' + 
                SUBSTRING(DT_R24.END_DATE,7,2) 
       END AS END_DATE
      ,DT_R24.RENRAKU_ID1 AS RENRAKU_ID1
      ,DT_R24.RENRAKU_ID2 AS RENRAKU_ID2
      ,DT_R24.RENRAKU_ID3 AS RENRAKU_ID3
      ,DT_R24.TUUCHI_ID AS TUUCHI_ID
      ,DT_R24.BIKOU AS BIKOU      
      ,DT_R24.READ_FLAG AS READ_FLAG
      ,DT_R24.UPDATE_TS AS TUUCHI_UPDATE_TS
      ,DT_MF_TOC.KANRI_ID AS KANRI_ID
      ,DT_MF_TOC.LATEST_SEQ AS LATEST_SEQ
      ,DT_MF_TOC.APPROVAL_SEQ AS APPROVAL_SEQ
      ,DT_MF_TOC.UPDATE_TS AS MOKUJI_UPDATE_TS
	  ,DT_R24.ACTION_FLAG AS ACTION_FLAG
From DT_R24 
       INNER JOIN DT_MF_TOC
               ON DT_R24.MANIFEST_ID = DT_MF_TOC.MANIFEST_ID
       INNER JOIN DT_R18
               ON DT_MF_TOC.KANRI_ID = DT_R18.KANRI_ID AND DT_MF_TOC.LATEST_SEQ = DT_R18.SEQ
	   INNER JOIN DT_R18_EX
			   ON DT_R18_EX.KANRI_ID = DT_R18.KANRI_ID AND DT_R18_EX.DELETE_FLG = 0
WHERE DT_R24.TUUCHI_CODE =  /*data.tuuchiCd*/  
/*IF data.tuuchiBiFrom != null && data.tuuchiBiFrom != ''*/
AND DT_R24.TUUCHI_DATE >= /*data.tuuchiBiFrom*/ /*END*/ 
/*IF data.tuuchiBiTo != null && data.tuuchiBiTo != ''*/
AND DT_R24.TUUCHI_DATE <= /*data.tuuchiBiTo*/ /*END*/ 
/*IF data.readFlag != null && data.readFlag == '2'*/
AND DT_R24.READ_FLAG = 0 /*END*/                    
/*IF  data.ApprovalFlg != null && data.ApprovalFlg  != ''*/
AND   (DT_R24.ACTION_FLAG IS NULL OR DT_R24.ACTION_FLAG = 0)
AND   DT_MF_TOC.APPROVAL_SEQ IS NOT NULL  /*END*/ 
ORDER BY DT_R24.TUUCHI_CODE

