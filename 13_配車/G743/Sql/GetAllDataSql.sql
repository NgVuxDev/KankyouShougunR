SELECT 
	'収集' AS DENSHU_KBN,
	E.UKETSUKE_NUMBER,
	right('00' + convert(varchar,E.KYOTEN_CD), 2) AS KYOTEN_CD,
	M_KYOTEN.KYOTEN_NAME,
	E.SAGYOU_DATE,
	E.GYOUSHA_CD,
	E.GYOUSHA_NAME,
	E.GENBA_CD,
	E.GENBA_NAME,
	E.UNPAN_GYOUSHA_CD,
	E.UNPAN_GYOUSHA_NAME,
	E.SHARYOU_CD,
	E.SHARYOU_NAME,
	E.SHASHU_CD,
	E.SHASHU_NAME,
	E.UNTENSHA_CD,
	E.UNTENSHA_NAME,
	E.SYSTEM_ID AS SYSTEM_ID_HIDDEN,
	E.SEQ AS SEQ_HIDDEN,
	isnull(M_GYOUSHA.SHOKUCHI_KBN,0) AS SHOKUCHI_KBN_HIDDEN,
	E.TORIHIKISAKI_CD,
	E.HOJOIN_CD,
	E.NIOROSHI_GYOUSHA_CD,
	E.NIOROSHI_GENBA_CD
FROM 
	T_UKETSUKE_SS_ENTRY AS E
INNER JOIN M_KYOTEN ON E.KYOTEN_CD = M_KYOTEN.KYOTEN_CD
INNER JOIN T_MOBISYO_RT AS T_RT ON E.UKETSUKE_NUMBER = T_RT.HAISHA_DENPYOU_NO AND T_RT.HAISHA_ROW_NUMBER = 1 AND T_RT.HAISHA_KBN = 1
LEFT JOIN M_GYOUSHA ON E.UNPAN_GYOUSHA_CD = M_GYOUSHA.GYOUSHA_CD
WHERE 
E.DELETE_FLG = 0
AND T_RT.DELETE_FLG = 0
AND E.UKETSUKE_NUMBER IN (/*$data.UketsukeNumber*/)
UNION
SELECT 
	'出荷' AS DENSHU_KBN,
	E.UKETSUKE_NUMBER,
	right('00' + convert(varchar,E.KYOTEN_CD), 2) AS KYOTEN_CD,
	M_KYOTEN.KYOTEN_NAME,
	E.SAGYOU_DATE,
	E.GYOUSHA_CD,
	E.GYOUSHA_NAME,
	E.GENBA_CD,
	E.GENBA_NAME,
	E.UNPAN_GYOUSHA_CD,
	E.UNPAN_GYOUSHA_NAME,
	E.SHARYOU_CD,
	E.SHARYOU_NAME,
	E.SHASHU_CD,
	E.SHASHU_NAME,
	E.UNTENSHA_CD,
	E.UNTENSHA_NAME,
	E.SYSTEM_ID AS SYSTEM_ID_HIDDEN,
	E.SEQ AS SEQ_HIDDEN,
	isnull(M_GYOUSHA.SHOKUCHI_KBN,0) AS SHOKUCHI_KBN_HIDDEN,
	E.TORIHIKISAKI_CD,
	E.HOJOIN_CD,
	'' AS NIOROSHI_GYOUSHA_CD,
	'' AS NIOROSHI_GENBA_CD
FROM 
	T_UKETSUKE_SK_ENTRY AS E
INNER JOIN M_KYOTEN ON E.KYOTEN_CD = M_KYOTEN.KYOTEN_CD
INNER JOIN T_MOBISYO_RT AS T_RT ON E.UKETSUKE_NUMBER = T_RT.HAISHA_DENPYOU_NO AND T_RT.HAISHA_ROW_NUMBER = 1 AND T_RT.HAISHA_KBN = 1
LEFT JOIN M_GYOUSHA ON E.UNPAN_GYOUSHA_CD = M_GYOUSHA.GYOUSHA_CD
WHERE 
E.DELETE_FLG = 0
AND T_RT.DELETE_FLG = 0
AND E.UKETSUKE_NUMBER IN (/*$data.UketsukeNumber*/)
ORDER BY
     E.UKETSUKE_NUMBER
    ,E.SAGYOU_DATE
    ,E.UNTENSHA_CD
    ,E.SHARYOU_CD