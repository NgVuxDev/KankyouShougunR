SELECT            
	TH1.SHARYOU_CD, 
	TH1.GYOUSHA_CD AS UNPAN_GYOUSHA_CD, 
	TH1.SHARYOU_NAME_RYAKU,
	TH1.SHASYU_CD,
	TH1.SHAIN_CD,
	MSH.SHASHU_NAME_RYAKU,
	MUN.SHAIN_NAME_RYAKU,
	M_GYOUSHA.GYOUSHA_NAME_RYAKU AS UNPAN_GYOUSHA_NAME
FROM              
	M_SHARYOU TH1
	LEFT JOIN M_SHASHU MSH
		ON MSH.SHASHU_CD = TH1.SHASYU_CD
	LEFT JOIN M_SHAIN MUN
		ON MUN.SHAIN_CD = TH1.SHAIN_CD
	LEFT JOIN M_GYOUSHA
		ON M_GYOUSHA.GYOUSHA_CD = TH1.GYOUSHA_CD
WHERE
        TH1.DELETE_FLG = 0
	AND TH1.SHARYOU_CD = /*data.SHARYOU_CD*/
/*IF data.SHASYU_CD != null*/ AND TH1.SHASYU_CD = /*data.SHASYU_CD*//*END*/
/*IF data.GYOUSHA_CD != null*/ AND TH1.GYOUSHA_CD = /*data.GYOUSHA_CD*//*END*/
	AND M_GYOUSHA.UNPAN_JUTAKUSHA_KAISHA_KBN = 1
    /*IF !TEKIYOU_DATE.IsNull*/ 
    AND (((M_GYOUSHA.TEKIYOU_BEGIN <= CONVERT(DATETIME, /*TEKIYOU_DATE*/, 120) AND CONVERT(DATETIME, /*TEKIYOU_DATE*/, 120) <= M_GYOUSHA.TEKIYOU_END) OR (M_GYOUSHA.TEKIYOU_BEGIN <= CONVERT(DATETIME, /*TEKIYOU_DATE*/, 120) AND M_GYOUSHA.TEKIYOU_END IS NULL) OR (M_GYOUSHA.TEKIYOU_BEGIN IS NULL AND CONVERT(DATETIME, /*TEKIYOU_DATE*/, 120) <= M_GYOUSHA.TEKIYOU_END) OR (M_GYOUSHA.TEKIYOU_BEGIN IS NULL AND M_GYOUSHA.TEKIYOU_END IS NULL)) AND M_GYOUSHA.DELETE_FLG <> 1) /*END*/
    /*IF TEKIYOU_DATE.IsNull*/ 
    AND (((M_GYOUSHA.TEKIYOU_BEGIN <= CONVERT(DATETIME, CONVERT(nvarchar, GETDATE(), 111), 120) AND CONVERT(DATETIME, CONVERT(nvarchar, GETDATE(), 111), 120) <= M_GYOUSHA.TEKIYOU_END) OR (M_GYOUSHA.TEKIYOU_BEGIN <= CONVERT(DATETIME, CONVERT(nvarchar, GETDATE(), 111), 120) AND M_GYOUSHA.TEKIYOU_END IS NULL) OR (M_GYOUSHA.TEKIYOU_BEGIN IS NULL AND CONVERT(DATETIME, CONVERT(nvarchar, GETDATE(), 111), 120) <= M_GYOUSHA.TEKIYOU_END) OR (M_GYOUSHA.TEKIYOU_BEGIN IS NULL AND M_GYOUSHA.TEKIYOU_END IS NULL)) AND M_GYOUSHA.DELETE_FLG <> 1) /*END*/
