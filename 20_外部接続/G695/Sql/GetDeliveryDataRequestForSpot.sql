SELECT 

	MSR.DIGI_SHARYOU_CD AS CAR_ID
	,MDG.POINT_ID
	,ENTRY.SAGYOU_DATE AS ARRIVAL_TIME
	,ENTRY.SAGYOU_DATE AS DEPARTURE_TIME
	,ENTRY.GENCHAKU_TIME
	,ENTRY.ROW_NO AS GOODS_DETAIL_NO
	,MDH.DIGI_HINMEI_CD AS GOODS_ID
	,ISNULL(ENTRY.SUURYOU, 0) AS GOODS_COUNT
	,MDU.DIGI_UNIT_CD AS GOODS_UNIT_ID
	--増えるかもしれないらしい
FROM 
	-- 収集受付
	(SELECT 
		ENT.SYSTEM_ID
		,DEL.DETAIL_SYSTEM_ID
		,DEL.ROW_NO
		,ENT.SAGYOU_DATE
		,ENT.GENCHAKU_TIME
		,ENT.GYOUSHA_CD
		,ENT.GENBA_CD
		,ENT.UNPAN_GYOUSHA_CD
		,ENT.SHARYOU_CD
		,DEL.SUURYOU
		,DEL.UNIT_CD
		,DEL.HINMEI_CD
		,1 AS DENPYOU_ATTR
	FROM
		T_UKETSUKE_SS_ENTRY ENT
	LEFT JOIN T_UKETSUKE_SS_DETAIL AS DEL ON ENT.SYSTEM_ID = DEL.SYSTEM_ID AND ENT.SEQ = DEL.SEQ
	LEFT JOIN M_HINMEI HINMEI ON DEL.HINMEI_CD = HINMEI.HINMEI_CD
	WHERE
		ENT.DELETE_FLG = 0
		AND ENT.SYSTEM_ID = /*SysId*/
	UNION ALL
	-- 出荷受付
	SELECT 
		ENT.SYSTEM_ID
		,DEL.DETAIL_SYSTEM_ID
		,DEL.ROW_NO
		,ENT.SAGYOU_DATE
		,ENT.GENCHAKU_TIME
		,ENT.GYOUSHA_CD
		,ENT.GENBA_CD
		,ENT.UNPAN_GYOUSHA_CD
		,ENT.SHARYOU_CD
		,DEL.SUURYOU
		,DEL.UNIT_CD
		,DEL.HINMEI_CD
		,2 AS DENPYOU_ATTR
	FROM
		T_UKETSUKE_SK_ENTRY ENT
	LEFT JOIN T_UKETSUKE_SK_DETAIL AS DEL ON ENT.SYSTEM_ID = DEL.SYSTEM_ID AND ENT.SEQ = DEL.SEQ
	LEFT JOIN M_HINMEI HINMEI ON DEL.HINMEI_CD = HINMEI.HINMEI_CD
	WHERE
		ENT.DELETE_FLG = 0
		AND ENT.SYSTEM_ID = /*SysId*/
	) AS ENTRY
LEFT JOIN M_DIGI_OUTPUT_SHARYOU  AS MSR ON ENTRY.UNPAN_GYOUSHA_CD = MSR.GYOUSHA_CD AND ENTRY.SHARYOU_CD = MSR.SHARYOU_CD
LEFT JOIN M_GENBA_DIGI           AS MDG ON ENTRY.GYOUSHA_CD = MDG.GYOUSHA_CD AND ENTRY.GENBA_CD = MDG.GENBA_CD
LEFT JOIN M_DIGI_OUTPUT_HINMEI   AS MDH ON ENTRY.HINMEI_CD = MDH.HINMEI_CD
LEFT JOIN M_DIGI_OUTPUT_UNIT     AS MDU ON ENTRY.UNIT_CD = MDU.UNIT_CD
